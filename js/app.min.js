function initMap(){map=new google.maps.Map(document.getElementById("map"),{disableDefaultUI:!0}),window.mapBounds=new google.maps.LatLngBounds;new google.maps.InfoWindow;google.maps.event.addDomListener(window,"resize",function(){map.fitBounds(mapBounds)}),ko.applyBindings(new listViewModel)}function googleError(){alert("Failed to access Google Maps API. Please check your connection and try again!")}function listViewModel(){var e=this,a=new google.maps.InfoWindow;e.itemToFilter=ko.observable(""),e.placesArray=ko.observableArray(placeData),e.placesArray().forEach(function(e){e.marker=new google.maps.Marker({map:map,position:{lat:e.lat,lng:e.lng},title:e.name}),$.getJSON("https://api.foursquare.com/v2/venues/"+e.venue+"?client_id="+FOURSQUARE_API_CLIENT+"&client_secret="+FOURSQUARE_API_SECRET+"&v=20130815&ll=37.7,-122").done(function(n){var o=n.response.venue,t=o.hasOwnProperty("description")?o.description:"",r="<div><h1>"+o.name+'</h1><div class="infowindow"><img src="'+o.bestPhoto.prefix+"210x210"+o.bestPhoto.suffix+'" alt="Image Location"></div><p><b>Category: </b>'+o.categories[0].name+"</p><p>"+t+"</p><p><b>Phone: </b>"+o.contact.formattedPhone+'</p><p><b>Address: </b> <a target="_blank" href=https://www.google.com/maps/dir/Current+Location/'+o.location.lat+","+o.location.lng+">"+o.location.formattedAddress+'</a></p><p><b>Source: </b><a target="_blank" href='+o.canonicalUrl+">Foursquare Page</a></div>";google.maps.event.addListener(e.marker,"click",function(){map.panTo(e.marker.getPosition()),e.marker.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.marker.setAnimation(null)},1400),a.setContent(r),a.open(map,e.marker)})}).fail(function(){var a=e.name+"<h5>Foursquare data is unavailable. Please try again!</h5>";e.infoWindow.setContent(a)}),google.maps.event.addListener(a,"closeclick",function(){map.fitBounds(mapBounds)}),mapBounds.extend(new google.maps.LatLng(e.lat,e.lng))}),e.markerClick=function(e){google.maps.event.trigger(e.marker,"click")},e.resetMarkers=function(){e.placesArray().forEach(function(e){e.marker.setVisible(!0),map.fitBounds(mapBounds),a.close()})},e.filteredItems=ko.computed(function(){var n=e.itemToFilter().toLowerCase();return n?ko.utils.arrayFilter(e.placesArray(),function(e){var o=e.name.toLowerCase().indexOf(n)>-1;return e.marker.setVisible(o),a.close(),o}):(e.placesArray()[0].hasOwnProperty("marker")&&e.resetMarkers(),e.placesArray())})}var map,FOURSQUARE_API_CLIENT="J5B15DIFBQULDELDRC00BET5PTEUKTEFUMFDZ5HAYSY2P33R",FOURSQUARE_API_SECRET="XIH1G3153DXNXBNSEFUEHFCPTMY0YVAGK5LWGZJQOQFQKLMY",placeData=[{name:"Island Taqueria",venue:"4dd857ab2271c5d36d52eaf0",lat:37.765768,lng:-122.241637},{name:"South Shore Cafe",venue:"4bc20e70b492d13a3fdca660",lat:37.75757837706282,lng:-122.25251336681507},{name:"Speisekammer",venue:"463de5c9f964a5203f461fe3",lat:37.766064487213704,lng:-122.2401211982562},{name:"USS Hornet Museum",venue:"4a6cbe2df964a5207dd11fe3",lat:37.772453282779324,lng:-122.30214357376097},{name:"Kamakura Japanese Restaurant",venue:"4645be7ef964a5207f461fe3",lat:37.763658373312516,lng:-122.23850548267365}];